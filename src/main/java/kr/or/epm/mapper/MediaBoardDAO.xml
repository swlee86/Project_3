<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.or.epm.DAO.MediaBoardDAO">
	
	<!-- 언론게시판 총 글수 -->
	<select id="selectCount" resultType="int"> 
		select count(*) 
		from media 
		where ${param1} like '%${param2}%'  
	</select>
	
	
	<!-- 언론게시판리스트 -->
	<select id="selectList" resultType="kr.or.epm.VO.MediaBoard"> 
		select no,emp_no,emp_name,hit,title,content,regdate,file_name from
					(select rownum num, n.no,n.emp_no,n.emp_name,n.hit,n.title,n.content,n.regdate,n.file_name
					 from 
					 	 (select no,emp_no,emp_name,hit,title,content,regdate,file_name
					 	  from media 
					 	  where ${param3} like '%${param4}%'  order by no desc
						  ) n
					) where num between 1 + (${param1} - 1) * ${param2} and  ${param2} + (${param1} - 1) * ${param2}
	</select>
	
	<!-- 언론게시판 글 상세내용 -->
	<select id="selectDetail" resultType="kr.or.epm.VO.MediaBoard">
		select emp_name,title,content,regdate,file_name
		from media
		where no = #{no}
	</select>

	<!-- 언론게시판 리플 글 보기-->
	<select id="selectReList" resultType="kr.or.epm.VO.MediaBoardReply">
		select emp_name, content, regdate
		from re_media
		where no = #{no} 
		order by re_no asc 
	</select>
	
	<!-- 회원 정보 부르기 -->
	<select id="selectInfoSearch" resultType="kr.or.epm.VO.Emp">
		select e.emp_name,e.emp_no
		from  emp_detail d join emp e
		on d. emp_no = e.emp_no
		where d.id=#{id}
	</select>
	
	<insert id="insertRow">
		insert into media(media_seq.nextval, emp_no, emp_name, hit, title, content, regdate, file_name)
				    values( #{seq}, #{emp_no}, #{emp_name}, 0, #{title}, #{content}, SYSDATE, #{file_name,jdbcType=VARCHAR})
	</insert>
</mapper>